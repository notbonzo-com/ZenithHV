#include <vga/font.h>
#include <vga/init.h>
#include <stdint.h>
#include <debug.h>
#include <stddef.h>
#include <stdarg.h>


uint16_t currentX = 0;
uint16_t currentY = 0;
// Each character is 8x8 pixels

//TODO Make a better way to store the font not wasting so much memory on empty characters
const unsigned char font[][8] = {
    // ASCII 0 (NUL): Null
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 1 (SOH): Start of Heading
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 2 (STX): Start of Text
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 3 (ETX): End of Text
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 4 (EOT): End of Transmission
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 5 (ENQ): Enquiry
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 6 (ACK): Acknowledge
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 7 (BEL): Bell
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 8 (BS): Backspace
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 9 (TAB): Horizontal Tab
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 10 (LF): Line Feed
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 11 (VT): Vertical Tab
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 12 (FF): Form Feed
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 13 (CR): Carriage Return
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 14 (SO): Shift Out
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 15 (SI): Shift In
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 16 (DLE): Data Link Escape
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 17 (DC1): Device Control 1 (XON)
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 18 (DC2): Device Control 2
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 19 (DC3): Device Control 3 (XOFF)
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 20 (DC4): Device Control 4
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 21 (NAK): Negative Acknowledge
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 22 (SYN): Synchronous Idle
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 23 (ETB): End of Transmission Block
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 24 (CAN): Cancel
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 25 (EM): End of Medium
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 26 (SUB): Substitute
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 27 (ESC): Escape
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 28 (FS): File Separator
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 29 (GS): Group Separator
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 30 (RS): Record Separator
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 31 (US): Unit Separator
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 32 (' '): Space
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 33 ('!'): Exclamation Mark
    {0x0C, 0x0C, 0x0C, 0x0C, 0x00, 0x0C, 0x00, 0x00},

    // ASCII 34 ('"'): Double Quotation Marks
    {0x36, 0x36, 0x36, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 35 ('#'): Hash or Pound
    {0x36, 0x36, 0x7F, 0x36, 0x7F, 0x36, 0x36, 0x00},

    // ASCII 36 ('$'): Dollar Sign
    {0x0C, 0x3E, 0x03, 0x1E, 0x30, 0x1F, 0x0C, 0x00},

    // ASCII 37 ('%'): Percent
    {0x63, 0x33, 0x06, 0x0C, 0x18, 0x33, 0x63, 0x00},

    // ASCII 38 ('&'): Ampersand
    {0x1C, 0x36, 0x1C, 0x6E, 0x33, 0x3E, 0x1B, 0x00},

    // ASCII 39 ('\''): Single Quotation Mark
    {0x0C, 0x0C, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 40 ('('): Left Parenthesis
    {0x06, 0x0C, 0x18, 0x18, 0x18, 0x0C, 0x06, 0x00},

    // ASCII 41 (')'): Right Parenthesis
    {0x18, 0x0C, 0x06, 0x06, 0x06, 0x0C, 0x18, 0x00},

    // ASCII 42 ('*'): Asterisk
    {0x00, 0x0C, 0x36, 0x1E, 0x3F, 0x1E, 0x36, 0x0C},

    // ASCII 43 ('+'): Plus
    {0x00, 0x0C, 0x0C, 0x3F, 0x0C, 0x0C, 0x00, 0x00},

    // ASCII 44 (','): Comma
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x0C, 0x06},

    // ASCII 45 ('-'): Hyphen
    {0x00, 0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x00},

    // ASCII 46 ('.'): Period
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x0C, 0x00},

    // ASCII 47 ('/'): Forward Slash
    {0x03, 0x06, 0x0C, 0x18, 0x30, 0x60, 0x40, 0x00},

    // ASCII 48 ('0'): Digit Zero
    {0x1C, 0x36, 0x63, 0x63, 0x63, 0x36, 0x1C, 0x00},

    // ASCII 49 ('1'): Digit One
    {0x0C, 0x1C, 0x0C, 0x0C, 0x0C, 0x0C, 0x3E, 0x00},

    // ASCII 50 ('2'): Digit Two
    {0x1C, 0x36, 0x06, 0x0C, 0x18, 0x30, 0x3E, 0x00},

    // ASCII 51 ('3'): Digit Three
    {0x1C, 0x36, 0x06, 0x0C, 0x06, 0x36, 0x1C, 0x00},

    // ASCII 52 ('4'): Digit Four
    {0x0C, 0x1C, 0x3C, 0x6C, 0x7E, 0x0C, 0x0C, 0x00},

    // ASCII 53 ('5'): Digit Five
    {0x3E, 0x30, 0x30, 0x3C, 0x06, 0x36, 0x1C, 0x00},

    // ASCII 54 ('6'): Digit Six
    {0x1C, 0x36, 0x30, 0x3C, 0x36, 0x36, 0x1C, 0x00},

    // ASCII 55 ('7'): Digit Seven
    {0x3E, 0x06, 0x0C, 0x18, 0x18, 0x18, 0x18, 0x00},

    // ASCII 56 ('8'): Digit Eight
    {0x1C, 0x36, 0x36, 0x1C, 0x36, 0x36, 0x1C, 0x00},

    // ASCII 57 ('9'): Digit Nine
    {0x1C, 0x36, 0x36, 0x1E, 0x06, 0x0C, 0x38, 0x00},

    // ASCII 58 (':'): Colon
    {0x00, 0x0C, 0x0C, 0x00, 0x0C, 0x0C, 0x00, 0x00},

    // ASCII 59 (';'): Semicolon
    {0x00, 0x0C, 0x0C, 0x00, 0x0C, 0x0C, 0x06, 0x00},

    // ASCII 60 ('<'): Less Than
    {0x00, 0x06, 0x0C, 0x18, 0x30, 0x18, 0x0C, 0x06},

    // ASCII 61 ('='): Equal Sign
    {0x00, 0x00, 0x3E, 0x00, 0x3E, 0x00, 0x00, 0x00},

    // ASCII 62 ('>'): Greater Than
    {0x00, 0x30, 0x18, 0x0C, 0x06, 0x0C, 0x18, 0x30},

    // ASCII 63 ('?'): Question Mark
    {0x1C, 0x36, 0x06, 0x0C, 0x0C, 0x00, 0x0C, 0x00},

    // ASCII 64 ('@'): At Sign
    {0x1C, 0x36, 0x36, 0x3E, 0x3E, 0x30, 0x1C, 0x00},

    // ASCII 65 ('A'): Capital 'A'
    {0x1C, 0x36, 0x63, 0x63, 0x7F, 0x63, 0x63, 0x00},

    // ASCII 66 ('B'): Capital 'B'
    {0x3E, 0x33, 0x33, 0x3E, 0x33, 0x33, 0x3E, 0x00},

    // ASCII 67 ('C'): Capital 'C'
    {0x1E, 0x33, 0x30, 0x30, 0x30, 0x33, 0x1E, 0x00},

    // ASCII 68 ('D'): Capital 'D'
    {0x3C, 0x36, 0x33, 0x33, 0x33, 0x36, 0x3C, 0x00},

    // ASCII 69 ('E'): Capital 'E'
    {0x7F, 0x30, 0x30, 0x3C, 0x30, 0x30, 0x7F, 0x00},

    // ASCII 70 ('F'): Capital 'F'
    {0x7F, 0x30, 0x30, 0x3C, 0x30, 0x30, 0x30, 0x00},

    // ASCII 71 ('G'): Capital 'G'
    {0x1E, 0x33, 0x30, 0x30, 0x37, 0x33, 0x1F, 0x00},

    // ASCII 72 ('H'): Capital 'H'
    {0x33, 0x33, 0x33, 0x3F, 0x33, 0x33, 0x33, 0x00},

    // ASCII 73 ('I'): Capital 'I'
    {0x0E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0E, 0x00},

    // ASCII 74 ('J'): Capital 'J'
    {0x1E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x38, 0x00},

    // ASCII 75 ('K'): Capital 'K'
    {0x33, 0x36, 0x3C, 0x38, 0x3C, 0x36, 0x33, 0x00},

    // ASCII 76 ('L'): Capital 'L'
    {0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x7F, 0x00},

    // ASCII 77 ('M'): Capital 'M'
    {0x63, 0x77, 0x7F, 0x7F, 0x7F, 0x63, 0x63, 0x00},

    // ASCII 78 ('N'): Capital 'N'
    {0x33, 0x33, 0x3B, 0x3F, 0x37, 0x33, 0x33, 0x00},

    // ASCII 79 ('O'): Capital 'O'
    {0x1C, 0x36, 0x63, 0x63, 0x63, 0x36, 0x1C, 0x00},

    // ASCII 80 ('P'): Capital 'P'
    {0x3E, 0x33, 0x33, 0x3E, 0x30, 0x30, 0x30, 0x00},

    // ASCII 81 ('Q'): Capital 'Q'
    {0x1C, 0x36, 0x63, 0x63, 0x63, 0x3E, 0x1B, 0x00},

    // ASCII 82 ('R'): Capital 'R'
    {0x3E, 0x33, 0x33, 0x3E, 0x3C, 0x36, 0x33, 0x00},

    // ASCII 83 ('S'): Capital 'S'
    {0x1F, 0x30, 0x30, 0x1E, 0x03, 0x03, 0x3E, 0x00},

    // ASCII 84 ('T'): Capital 'T'
    {0x3E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x00},

    // ASCII 85 ('U'): Capital 'U'
    {0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x1E, 0x00},

    // ASCII 86 ('V'): Capital 'V'
    {0x33, 0x33, 0x33, 0x33, 0x33, 0x1E, 0x0C, 0x00},

    // ASCII 87 ('W'): Capital 'W'
    {0x63, 0x63, 0x63, 0x7F, 0x7F, 0x36, 0x36, 0x00},

    // ASCII 88 ('X'): Capital 'X'
    {0x33, 0x33, 0x33, 0x1E, 0x0C, 0x0C, 0x0C, 0x00},

    // ASCII 89 ('Y'): Capital 'Y'
    {0x33, 0x33, 0x33, 0x1E, 0x0C, 0x0C, 0x0C, 0x00},

    // ASCII 90 ('Z'): Capital 'Z'
    {0x7F, 0x03, 0x06, 0x0C, 0x18, 0x30, 0x7F, 0x00},

    // ASCII 91 ('['): Left Square Bracket
    {0x0E, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0E, 0x00},

    // ASCII 92 ('\'): Backslash
    {0x00, 0x00, 0x40, 0x60, 0x30, 0x18, 0x0C, 0x06},

    // ASCII 93 (']'): Right Square Bracket
    {0x70, 0x30, 0x30, 0x30, 0x30, 0x30, 0x70, 0x00},

    // ASCII 94 ('^'): Caret
    {0x0C, 0x1E, 0x33, 0x33, 0x00, 0x00, 0x00, 0x00},

    // ASCII 95 ('_'): Underscore
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF},

    // ASCII 96 ('`'): Backtick
    {0x18, 0x0C, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00},

    // ASCII 97 ('a'): Lowercase 'a'
    {0x00, 0x00, 0x1C, 0x06, 0x1E, 0x36, 0x1D, 0x00},

    // ASCII 98 ('b'): Lowercase 'b'
    {0x30, 0x30, 0x3C, 0x36, 0x33, 0x36, 0x3C, 0x00},

    // ASCII 99 ('c'): Lowercase 'c'
    {0x00, 0x00, 0x1E, 0x30, 0x30, 0x30, 0x1E, 0x00},

    // ASCII 100 ('d'): Lowercase 'd'
    {0x06, 0x06, 0x1E, 0x36, 0x36, 0x36, 0x1F, 0x00},

    // ASCII 101 ('e'): Lowercase 'e'
    {0x00, 0x00, 0x1C, 0x36, 0x3E, 0x30, 0x1E, 0x00},

    // ASCII 102 ('f'): Lowercase 'f'
    {0x0E, 0x18, 0x18, 0x7C, 0x18, 0x18, 0x18, 0x00},

    // ASCII 103 ('g'): Lowercase 'g'
    {0x00, 0x00, 0x1F, 0x36, 0x36, 0x1E, 0x06, 0x3C},

    // ASCII 104 ('h'): Lowercase 'h'
    {0x30, 0x30, 0x3C, 0x36, 0x33, 0x33, 0x33, 0x00},

    // ASCII 105 ('i'): Lowercase 'i'
    {0x0C, 0x00, 0x0C, 0x0C, 0x0C, 0x0C, 0x0E, 0x00},

    // ASCII 106 ('j'): Lowercase 'j'
    {0x06, 0x00, 0x06, 0x06, 0x06, 0x36, 0x1C, 0x00},

    // ASCII 107 ('k'): Lowercase 'k'
    {0x30, 0x30, 0x33, 0x36, 0x3C, 0x36, 0x33, 0x00},

    // ASCII 108 ('l'): Lowercase 'l'
    {0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x07, 0x00},

    // ASCII 109 ('m'): Lowercase 'm'
    {0x00, 0x00, 0x77, 0x7F, 0x7F, 0x6B, 0x63, 0x00},

    // ASCII 110 ('n'): Lowercase 'n'
    {0x00, 0x00, 0x3C, 0x36, 0x33, 0x33, 0x00, 0x00},

    // ASCII 111 ('o'): Lowercase 'o'
    {0x00, 0x00, 0x1E, 0x33, 0x33, 0x33, 0x1E, 0x00},

    // ASCII 112 ('p'): Lowercase 'p'
    {0x00, 0x00, 0x3C, 0x36, 0x33, 0x3C, 0x30, 0x30},

    // ASCII 113 ('q'): Lowercase 'q'
    {0x00, 0x00, 0x1F, 0x36, 0x36, 0x1E, 0x06, 0x06},

    // ASCII 114 ('r'): Lowercase 'r'
    {0x00, 0x00, 0x3B, 0x3E, 0x30, 0x30, 0x00, 0x00},

    // ASCII 115 ('s'): Lowercase 's'
    {0x00, 0x00, 0x1F, 0x30, 0x1E, 0x03, 0x3E, 0x00},

    // ASCII 116 ('t'): Lowercase 't'
    {0x18, 0x18, 0x7E, 0x18, 0x18, 0x18, 0x0E, 0x00},

    // ASCII 117 ('u'): Lowercase 'u'
    {0x00, 0x00, 0x33, 0x33, 0x33, 0x33, 0x1E, 0x00},

    // ASCII 118 ('v'): Lowercase 'v'
    {0x00, 0x00, 0x33, 0x33, 0x33, 0x1E, 0x0C, 0x00},

    // ASCII 119 ('w'): Lowercase 'w'
    {0x00, 0x00, 0x63, 0x63, 0x7F, 0x36, 0x36, 0x00},

    // ASCII 120 ('x'): Lowercase 'x'
    {0x00, 0x00, 0x33, 0x1E, 0x0C, 0x1E, 0x33, 0x00},

    // ASCII 121 ('y'): Lowercase 'y'
    {0x00, 0x00, 0x33, 0x33, 0x33, 0x1F, 0x06, 0x3C},

    // ASCII 122 ('z'): Lowercase 'z'
    {0x00, 0x00, 0x3E, 0x0C, 0x18, 0x30, 0x3E, 0x00},

    // ASCII 123 ('{'): Left Curly Brace
    {0x0E, 0x0C, 0x0C, 0x18, 0x0C, 0x0C, 0x0E, 0x00},

    // ASCII 124 ('|'): Vertical Bar (Pipe)
    {0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x00},

    // ASCII 125 ('}'): Right Curly Brace
    {0x70, 0x30, 0x30, 0x18, 0x30, 0x30, 0x70, 0x00},

    // ASCII 126 ('~'): Tilde
    {0x00, 0x00, 0x33, 0x1E, 0x00, 0x00, 0x00, 0x00}
};

void VISUAL_DrawCharacterASCII(int x, int y, uint32_t color, int asciiNumber) {
    if (asciiNumber < 31 || asciiNumber > 126) {
        // ASCII number out of printable ASCII range, do nothing
        return;
    }

    for (int row = 0; row < 8; row++) {
        unsigned char rowData = font[asciiNumber][row];
        
        for (int col = 0; col < 8; col++) {
            if (rowData & (0x80 >> col)) {
                int pixelX = x + col;
                int pixelY = y + row;
                
                // if (pixelX >= 0 && pixelX < (int)g_Framebuffer->width && pixelY >= 0 && pixelY < (int)g_Framebuffer->height) {
                //     // Ensure the pixel is within the framebuffer bounds
                //     log_debug("Visual", "PixelX: %d, PixelY: %d", pixelX, pixelY);
                //     ((uint32_t*)(g_Framebuffer->address))[pixelY * g_Framebuffer->width + pixelX] = color;
                // }
                VISUAL_SetPixel(pixelX, pixelY, color, 1);
            }
        }
    }
}

int ConvertCharacterToASCIINumber(unsigned char character) {
    const int mappingTable[] = {
        // Control characters (0-31) and space (32)
        0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7,
        8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15,
        16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23,
        24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31,
        ' ', 32,

        // Printable characters (33-126)
        '!', 33, '"', 34, '#', 35, '$', 36, '%', 37, '&', 38, '\'', 39,
        '(', 40, ')', 41, '*', 42, '+', 43, ',', 44, '-', 45, '.', 46, '/', 47,
        '0', 48, '1', 49, '2', 50, '3', 51, '4', 52, '5', 53, '6', 54, '7', 55,
        '8', 56, '9', 57, ':', 58, ';', 59, '<', 60, '=', 61, '>', 62, '?', 63,
        '@', 64, 'A', 65, 'B', 66, 'C', 67, 'D', 68, 'E', 69, 'F', 70, 'G', 71,
        'H', 72, 'I', 73, 'J', 74, 'K', 75, 'L', 76, 'M', 77, 'N', 78, 'O', 79,
        'P', 80, 'Q', 81, 'R', 82, 'S', 83, 'T', 84, 'U', 85, 'V', 86, 'W', 87,
        'X', 88, 'Y', 89, 'Z', 90, '[', 91, '\\', 92, ']', 93, '^', 94, '_', 95,
        '`', 96, 'a', 97, 'b', 98, 'c', 99, 'd', 100, 'e', 101, 'f', 102, 'g', 103,
        'h', 104, 'i', 105, 'j', 106, 'k', 107, 'l', 108, 'm', 109, 'n', 110, 'o', 111,
        'p', 112, 'q', 113, 'r', 114, 's', 115, 't', 116, 'u', 117, 'v', 118, 'w', 119,
        'x', 120, 'y', 121, 'z', 122, '{', 123, '|', 124, '}', 125, '~', 126
    };  

    size_t tableSize = sizeof(mappingTable) / sizeof(mappingTable[0]);
    for (size_t i = 0; i < tableSize; i += 2) {
        if (character == mappingTable[i]) {
            return mappingTable[i + 1];
        }
    }
    return -1;
}

void VISUAL_DrawCharacterSymbol(int x, int y, uint32_t color, unsigned char character) {
    int asciiNumber = ConvertCharacterToASCIINumber(character);

    if (asciiNumber >= 0 && asciiNumber >= 31 && asciiNumber <= 126) {
        VISUAL_DrawCharacterASCII(x, y, color, asciiNumber);
    } else {
        log_err("Visual Font", "Invalid character: %c", character);
    }
}

void VISUAL_putc(const char c)
{
    if (c == '\n')
    {
        currentX = 0;
        currentY += 8;
    }
    else
    {
        VISUAL_DrawCharacterSymbol(currentX, currentY, 0xFFFFFFFF, c);
        currentX += 8;
    }
}

void VISUAL_puts(const char* str)
{
    while (*str)
    {
        VISUAL_putc(*str++);
    }
}